ä½œè€…ï¼šæŸ“å±±    æ›´æ–°æ—¥æœŸï¼š20250803

### å®Œæ•´çš„å­Ÿå¾·å°”éšæœºåŒ–ï¼ˆMendelian Randomization, MRï¼‰åˆ†ææµç¨‹ï¼ŒåŒ…æ‹¬ï¼š

    åˆ†ææ¦‚è¿°

    åˆ†ææµç¨‹å›¾

    æ¯ä¸€æ­¥çš„è¯¦ç»†æ­¥éª¤ä¸ä»£ç 

    å¸¸ç”¨RåŒ…ä¸å¯è§†åŒ–æ–¹æ³•

---

## ğŸ§¬ ä¸€ã€åˆ†ææ¦‚è¿°

**å­Ÿå¾·å°”éšæœºåŒ–ï¼ˆMRï¼‰**æ˜¯ä¸€ç§åˆ©ç”¨é—ä¼ å˜å¼‚ï¼ˆSNPsï¼‰ä½œä¸ºå·¥å…·å˜é‡ï¼ˆInstrumental Variables, IVsï¼‰è¯„ä¼°æš´éœ²ï¼ˆexposureï¼‰ä¸ç»“å±€ï¼ˆoutcomeï¼‰ä¹‹é—´å› æœå…³ç³»çš„æ–¹æ³•ï¼ŒåŸºäºé—ä¼ å˜å¼‚åœ¨å‡ºç”Ÿæ—¶è¢«éšæœºåˆ†é…çš„åŸç†ã€‚

## ğŸ” äºŒã€åˆ†ææµç¨‹å›¾

graph TD
  A[é€‰æ‹©Exposure] --> B[è·å–Exposure GWAS summary data]
  B --> C[ç­›é€‰æ˜¾è‘—SNPs (P<5e-8)]
  C --> D[LDå‰ªæ (R2<0.01, 10,000kb)]
  D --> E[æå–Outcome GWASæ•°æ®]
  E --> F[Harmonization (å¯¹é½æ•ˆåº”ç­‰ä½åŸºå› )]
  F --> G[MRå› æœæ¨æ–­åˆ†æ]
  G --> H[æ•æ„Ÿæ€§åˆ†æ: å¼‚è´¨æ€§/å¤šæ•ˆæ€§æ£€éªŒ]
  H --> I[ç»“æœå¯è§†åŒ–ä¸è§£é‡Š]

## ğŸ§ª ä¸‰ã€åˆ†ææ­¥éª¤ä¸ä»£ç ï¼ˆåŸºäº R TwoSampleMR åŒ…ï¼‰

    æ‰€éœ€ R åŒ…ï¼šTwoSampleMR, MRPRESSO, data.table, dplyr, ggplot2

---

## âœ… Step 1. å®‰è£…å¹¶åŠ è½½ R åŒ…

```r
install.packages("remotes")
remotes::install_github("MRCIEU/TwoSampleMR")
remotes::install_github("rondolab/MR-PRESSO")

library(TwoSampleMR)
library(MRPRESSO)
library(data.table)
library(dplyr)
library(ggplot2)
```

## âœ… Step 2. é€‰æ‹© Exposure å’Œ Outcome

ä¾‹å¦‚ï¼šBMIï¼ˆExposureï¼‰ä¸å† å¿ƒç—… CHDï¼ˆOutcomeï¼‰

```r
available_exposures <- available_exposures()
available_outcomes <- available_outcomes()
```

ä½ ä¹Ÿå¯ä»¥ä¸‹è½½ GWAS summary æ–‡ä»¶ï¼Œè‡ªå®šä¹‰æ•°æ®ã€‚

## âœ… Step 3. è·å– Exposure çš„GWASæ•°æ®

```r
# ç¤ºä¾‹: é€‰æ‹©BMIä½œä¸ºexposure (ID: ukb-b-19953)
exposure_data <- extract_instruments(outcomes = "ukb-b-19953", clump = TRUE)
```

## âœ… Step 4. æå– Outcome æ•°æ®

```r
# é€‰æ‹©å† å¿ƒç—… (ID: ebi-a-GCST003116)
outcome_data <- extract_outcome_data(
  snps = exposure_data$SNP,
  outcomes = "ebi-a-GCST003116"
)
```

## âœ… Step 5. Harmonize Exposure ä¸ Outcome æ•°æ®

```r
harmonized_data <- harmonise_data(exposure_data, outcome_data)
```

## âœ… Step 6. è¿›è¡Œ MR åˆ†æ

```r
mr_results <- mr(harmonized_data)
print(mr_results)
```

å¸¸è§æ–¹æ³•åŒ…æ‹¬ï¼š

    IVWï¼ˆInverse Variance Weightedï¼‰

    MR-Egger

    Weighted median

## âœ… Step 7. æ•æ„Ÿæ€§åˆ†æ

```r
# 7.1 å¼‚è´¨æ€§æ£€éªŒ

mr_heterogeneity(harmonized_data)

# 7.2 å¤šæ•ˆæ€§æ£€éªŒ

mr_pleiotropy_test(harmonized_data)

# 7.3 å•SNPåˆ†æ

mr_singlesnp(harmonized_data) %>%
  mr_forest_plot()

# 7.4 Leave-one-outåˆ†æ

mr_leaveoneout(harmonized_data) %>%
  mr_leaveoneout_plot()

# 7.5 PRESSOåˆ†æï¼ˆæ£€æµ‹å¼‚å¸¸å€¼ï¼‰

MRPRESSO::mr_presso(BetaOutcome = "beta.outcome",
                    BetaExposure = "beta.exposure",
                    SdOutcome = "se.outcome",
                    SdExposure = "se.exposure",
                    OUTLIERtest = TRUE,
                    DISTORTIONtest = TRUE,
                    data = harmonized_data,
                    NbDistribution = 1000,
                    SignifThreshold = 0.05)
```

## âœ… Step 8. å¯è§†åŒ–ç»“æœ

```r
# æ•£ç‚¹å›¾

mr_scatter_plot(mr_results, harmonized_data)

# ç«å±±å›¾ï¼ˆVolcano plotï¼‰

library(ggplot2)

ggplot(mr_results, aes(x = method, y = b, color = method)) +
  geom_point(size = 4) +
  geom_errorbar(aes(ymin = b - se, ymax = b + se), width = 0.2) +
  theme_minimal() + labs(y = "Effect Estimate (Beta)", x = "")
```

## ğŸ“¦ å››ã€å…¶ä»–å¸¸ç”¨èµ„æº

    GWAS æ•°æ®åº“ï¼š

        IEU OpenGWAS

        GWAS Catalog

    è‡ªå®šä¹‰ GWAS æ–‡ä»¶ä½¿ç”¨ read_exposure_data() å’Œ read_outcome_data()

## ğŸ“ äº”ã€ç¤ºä¾‹ç»“è®ºè§£è¯»æ¨¡æ¿

ä½¿ç”¨ TwoSampleMR åŒ…å¯¹ BMI ä¸å† å¿ƒç—…ï¼ˆCHDï¼‰ä¹‹é—´çš„å…³ç³»è¿›è¡Œäº† MR åˆ†æã€‚IVW æ–¹æ³•ç»“æœæ˜¾ç¤º Î² = 0.11, p = 3e-5ï¼Œæç¤º BMI å¢åŠ æ˜¾è‘—å¢åŠ CHDé£é™©ã€‚æ•æ„Ÿæ€§åˆ†ææœªå‘ç°æ˜¾è‘—å¼‚è´¨æ€§æˆ–å¤šæ•ˆæ€§ã€‚ç»“æœå…·æœ‰ç¨³å¥æ€§ã€‚

## ğŸ“ å…­ã€ç»“æœæ±‡æ€»è¡¨æ ¼å»ºè®®
| Method	| Beta	| SE	| P-value	| OR	| 95%CI |
|----|----|----|----|----|----|
| IVW	| 0.11	| 0.02	| 3e-5	| 1.12	| 1.07â€“1.17 |
| MR-Egger	| 0.09	| 0.05	| 0.07	| -	| - |
| Weighted Med	| 0.10	| 0.03	| 0.001	| 1.11	| 1.04â€“1.18 |
